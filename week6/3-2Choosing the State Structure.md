ìƒíƒœë¥¼ ì˜ êµ¬ì¡°í™”í•˜ë©´ ìˆ˜ì •ê³¼ ë””ë²„ê¹…ì´ í¸í•œ ì»´í¬ë„ŒíŠ¸ì™€ ë²„ê·¸ê°€ ëŠì„ì—†ì´ ë°œìƒí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ì°¨ì´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<aside>
ğŸ’¡ ë°°ìš¸ ë‚´ìš©
- í•˜ë‚˜ ë˜ëŠ” ì—¬ëŸ¬ê°œì˜ ìƒíƒœ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- ìƒíƒœ ì •ë¦¬ ì‹œ í”¼í•´ì•¼í•  ë‚´ìš©
- ìƒíƒœ êµ¬ì¡°ì™€ í•¨ê»˜ ì¼ë°˜ì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•

</aside>

## **Principles for structuring state**

ìƒíƒœë¥¼ ê°€ì§€ê³  ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ì„±í•  ë•Œ, ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë§ì€ ìƒíƒœ ë³€ìˆ˜ë¥¼ ì„ íƒí•  ìˆ˜ ìˆê³  ê·¸ ë°ì´í„°ì˜ ëª¨ì–‘ì„ ì–´ë–»ê²Œ í• ì§€ ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœì ì´ ì•„ë‹Œ ìƒíƒœ êµ¬ì¡°ë¡œë„ ì˜¬ë°”ë¥¸ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•  ìˆ˜ ìˆì§€ë§Œ, ë” ë‚˜ì€ ì„ íƒì„ ìœ„í•´ì„œ ëª‡ ê°€ì§€ ì›ì¹™ì´ ìˆìŠµë‹ˆë‹¤.

1. ê´€ë ¨ëœ ìƒíƒœë¼ë¦¬ ê·¸ë£¹í™”í•˜ê¸°: í•­ìƒ ê°™ì€ ì‹œì ì— ë‘ê°œ ì´ìƒì˜ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤ë©´, í•˜ë‚˜ì˜ ìƒíƒœ ë³€ìˆ˜ë¡œ í•©ì¹˜ëŠ” ê²ƒì„ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
2. ìƒíƒœì—ì„œ ëª¨ìˆœ í”¼í•˜ê¸°: ì—¬ëŸ¬ ìƒíƒœê°€ ì„œë¡œ ëª¨ìˆœë˜ê³  ë¶ˆì¼ì¹˜ í•  ìˆ˜ ìˆëŠ” ë°©ì‹ìœ¼ë¡œ ìƒíƒœë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒì€ ì‹¤ìˆ˜ê°€ ë°œìƒí•  ì—¬ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤. ì´ë¥¼ í”¼í•˜ì„¸ìš”
3. ë¶ˆí•„ìš”í•œ ìƒíƒœ í”¼í•˜ê¸°: ì»´í¬ë„ŒíŠ¸ì˜ props ë˜ëŠ” ìƒíƒœë¥¼ í†µí•´ì„œ ë Œë”ë§ ë™ì•ˆ ìƒíƒœë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤ë©´, ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœì— í•´ë‹¹ ì •ë³´ë¥¼ ë„£ì§€ ì•Šì•„ì•¼í•©ë‹ˆë‹¤.
4. ìƒíƒœì˜ ì¤‘ë³µ í”¼í•˜ê¸°: ì—¬ëŸ¬ê°œì˜ ìƒíƒœ ë³€ìˆ˜ ì‚¬ì´, ì¤‘ì²©ëœ ê°ì²´ì—ì„œ ê°™ì€ ë°ì´í„°ì˜ ì¤‘ë³µë  ê²½ìš° ë™ê¸°í™” í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ ì¤‘ë³µì„ ì¤„ì´ì„¸ìš”.
5. ê¹Šì€ ì¤‘ì²© í”¼í•˜ê¸°: ê¹Šê²Œ ê³„ì¸µí™”ëœ ìƒíƒœëŠ” ì—…ë°ì´íŠ¸í•˜ê¸° ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°€ëŠ¥í•˜ë‹¤ë©´ í‰íƒ„í™”ëœ ìƒíƒœêµ¬ì¡°ë¥¼ ì„ í˜¸í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì›ì¹™ì„ í†µí•œ ëª©í‘œëŠ” ì‹¤ìˆ˜ì—†ì´ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¥¼ ì‰½ê²Œ ë§Œë“¤ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ìƒí…Œì—ì„œ ì¤‘ë³µ ë°ì´í„°ì™€ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ê²ƒì€ ëª¨ë“  ë°ì´í„°ê°€ ë™ê¸°í™” ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§€ë‹ˆì–´ê°€ ë²„ê·¸ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ì •ê·œí™”í•˜ëŠ” ë°©ë²•ê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤. ì•Œë²„íŠ¸ ì•„ì¸ìŠˆíƒ€ì¸ì˜ ë§ì„ ì¸ìš©í•œë‹¤ë©´, ë‹¹ ìƒíƒœë¥¼ ê°€ëŠ¥í•œí•œ ë‹¨ìˆœí•˜ê²Œ ë§Œë“¤ì–´ì•¼í•©ë‹ˆë‹¤, ë” ë‹¨ìˆœí•˜ê²Œê°€ ì•„ë‹ˆë¼.

## **Group related state**

ì¢…ì¢… í•˜ë‚˜ì˜ ìƒíƒœ ë˜ëŠ” ì—¬ëŸ¬ ìƒíƒœ ì‚¬ì´ì—ì„œ ê³ ë¯¼í•  ë•Œê°€ ìˆìŠµë‹ˆë‹¤.

```tsx
const [x, setX] = useState(0);
const [y, setY] = useState(0);

ë˜ëŠ”

const [position, setPosition] = useState({ x: 0, y: 0 });
```

ê¸°ìˆ ì ìœ¼ë¡œ, ë‹¹ì‹ ì€ ì´ëŸ¬í•œ ì ‘ê·¼ë“¤ì„ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë‘ê°œì˜ ìƒíƒœë³€ìˆ˜ê°€ í•­ìƒ í•¨ê»˜ ë³€í•œë‹¤ë©´ í•˜ë‚˜ì˜ ìƒíƒœë¡œ ì •ì˜í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ ì›€ì§ì´ë©´ ë¹¨ê°„ ì ì˜ ë‘ ì¢Œí‘œê°€ ëª¨ë‘ ì—…ë°ì´íŠ¸ë˜ëŠ” ì´ ì˜ˆì œì²˜ëŸ¼ í•­ìƒ ë™ê¸°í™”ë¥¼ ìœ ì§€í•˜ëŠ” ê²ƒì„ ìŠì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.

```tsx
export default function MovingDot() {
  const [position, setPosition] = useState({
    x: 0,
    y: 0
  });
  
  return (
    <div
      onPointerMove={e => {
        setPosition({
          x: e.clientX,
          y: e.clientY
        });
      }}
      style={{
        position: 'relative',
        width: '100vw',
        height: '100vh',
      }}>
      <div style={{
        position: 'absolute',
        backgroundColor: 'red',
        borderRadius: '50%',
        transform: `translate(${position.x}px, ${position.y}px)`,
        left: -10,
        top: -10,
        width: 20,
        height: 20,
      }} />
    </div>
  )
}

```

ë˜ ë‹¤ë¥¸ ê²½ìš°ëŠ” ê°ì²´ ë˜ëŠ” ë°°ì—´ë¡œ ê·¸ë£¹í™” í•˜ëŠ” ë°ì´í„°ê°€ ì–¼ë§ˆë‚˜ ë§ì€ ìƒíƒœë¥¼ ê°€ì ¸ì•¼í•˜ëŠ”ì§€ ëª¨ë¥´ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìœ ì €ê°€ í¼ì— ì»¤ìŠ¤í…€ í•„ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ê²½ìš° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

 

<aside>
ğŸ’¡ ìƒíƒœ ë³€ìˆ˜ê°€ ê°ì²´ì¸ ê²½ìš° ë‹¤ë¥¸ í•„ë“œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë³µì‚¬í•˜ì§€ ì•Šê³  í•˜ë‚˜ì˜ í•„ë“œë§Œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. ì˜ˆë¥¼ë“¤ì–´ ìœ„ ì˜ˆì œì˜ ê²½ìš° `setPosition({ x: 100 })` ë¼ê³  í•  ìˆ˜ ì—†ë‹¤. ì™œëƒí•˜ë©´ y í”„ë¡œí¼í‹°ë¥¼ ê°€ì§€ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ëŒ€ì‹ ì— xë§Œ ì—…ë°ì´íŠ¸í•˜ê¸¸ ì›í•œë‹¤ë©´, `setPosition({â€¦position, x: 100})` ë˜ëŠ” ìƒíƒœë¥¼ ë¶„ë¦¬í•˜ì—¬ `setX(100)` ì™€ ê°™ì´ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</aside>

## **Avoid contradictions in state**

`isSending` ê³¼ `isSent` ìƒíƒœë¥¼ ê°€ì§„ í˜¸í…” ë§Œì¡±ë„ ì¡°ì‚¬ í¼ì´ ìˆìŠµë‹ˆë‹¤.

```tsx
export default function FeedbackForm() {
  const [text, setText] = useState('');
  const [isSending, setIsSending] = useState(false);
  const [isSent, setIsSent] = useState(false);

  async function handleSubmit(e) {
    e.preventDefault();
    setIsSending(true);
    await sendMessage(text);
    setIsSending(false);
    setIsSent(true);
  }

  if (isSent) {
    return <h1>Thanks for feedback!</h1>
  }

  return (
    <form onSubmit={handleSubmit}>
      <p>How was your stay at The Prancing Pony?</p>
      <textarea
        disabled={isSending}
        value={text}
        onChange={e => setText(e.target.value)}
      />
      <br />
      <button
        disabled={isSending}
        type="submit"
      >
        Send
      </button>
      {isSending && <p>Sending...</p>}
    </form>
  );
}

// Pretend to send a message.
function sendMessage(text) {
  return new Promise(resolve => {
    setTimeout(resolve, 2000);
  });
}
```

ì½”ë“œê°€ ë™ì‘í•˜ì§€ë§Œ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì— ëŒ€í•œ ë¬¸ì„ ì—´ì–´ë‘¡ë‹ˆë‹¤. ì˜ˆë¥¼ë“¤ì–´, `setIsSent`ì™€ `setIsSending` ì„ ë™ì‹œì— í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ìŠì—ˆë‹¤ë©´, `isSending` ê³¼ `isSent` ê°€ ê°™ì€ ì‹œê°„ì— `true` ì¸ ìƒí™©ì´ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë” ë³µì¡í•œ ì»´í¬ë„ŒíŠ¸ë¼ë©´ ì™œ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ì§€ ì´í•´í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.

`isSending`ê³¼ `isSent` ê°€ ê°™ì€ ì‹œì ì— `true` ì—¬ì„œëŠ” ì•ˆë˜ê¸° ë•Œë¬¸ì— ì´ ë‘ ë³€ìˆ˜ë¥¼ `'typing'`(ì´ˆê¹ƒê°’), `'sending'`, `'sent'` ì„¸ ê°€ì§€ ìœ íš¨í•œ ìƒíƒœ ì¤‘ í•˜ë‚˜ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ” `status` ìƒíƒœ ë³€ìˆ˜ë¡œ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```tsx
export default function FeedbackForm() {
  const [text, setText] = useState('');
  - const [isSending, setIsSending] = useState(false);
  - const [isSent, setIsSent] = useState(false);
  + const [status, setStatus] = useState('typing');

  async function handleSubmit(e) {
    e.preventDefault();
    - setIsSending(true);
    + setStatus('sending');
    await sendMessage(text);
    - setIsSending(false);
    - setIsSent(true);
    + setStatus('sent');
  }
  
  + const isSending = status === 'sending';
  + const isSent = status === 'send'; 

  if (isSent) {
    return <h1>Thanks for feedback!</h1>
  }

  return (
    <form onSubmit={handleSubmit}>
      <p>How was your stay at The Prancing Pony?</p>
      <textarea
        disabled={isSending}
        value={text}
        onChange={e => setText(e.target.value)}
      />
      <br />
      <button
        disabled={isSending}
        type="submit"
      >
        Send
      </button>
      {isSending && <p>Sending...</p>}
    </form>
  );
}
```

ê°€ë…ì„±ì„ ìœ„í•´ì„œ ì¼ë¶€ ìƒìˆ˜ë¥¼ ì„ ì–¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
const isSending = status === 'sending';
const isSent = status === 'send'; 
```

ê·¸ëŸ¬ë‚˜ ìƒìˆ˜ë“¤ì€ ìƒíƒœ ë³€ìˆ˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ì„œë¡œ ë™ê¸°í™”ë¥¼ ê±±ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

## **Avoid redundant state**

ë Œë”ë§ ì¤‘ì— ì»´í¬ë„ŒíŠ¸ì˜ propsë‚˜ ê¸°ì¡´ state ë³€ìˆ˜ì—ì„œ ì¼ë¶€ ì •ë³´ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤ë©´, ì»´í¬ë„ŒíŠ¸ì˜ stateì— í•´ë‹¹ ì •ë³´ë¥¼ ë„£ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤**.**

ì•„ë˜ í¼ì— ì˜ˆì œê°€ ìˆìŠµë‹ˆë‹¤. ë™ì‘í•˜ì§€ë§Œ ì¤‘ë³µ ìƒíƒœë¥¼ ì°¾ì„ ìˆ˜ ìˆë‚˜ìš”?

```tsx
export default function Form() {
  const [firstName, setFirstName] = useState('');
  const [lastName, setLastName] = useState('');
  const [fullName, setFullName] = useState('');

  function handleFirstNameChange(e) {
    setFirstName(e.target.value);
    setFullName(e.target.value + ' ' + lastName);
  }

  function handleLastNameChange(e) {
    setLastName(e.target.value);
    setFullName(firstName + ' ' + e.target.value);
  }

  return (
    <>
      <h2>Letâ€™s check you in</h2>
      <label>
        First name:{' '}
        <input
          value={firstName}
          onChange={handleFirstNameChange}
        />
      </label>
      <label>
        Last name:{' '}
        <input
          value={lastName}
          onChange={handleLastNameChange}
        />
      </label>
      <p>
        Your ticket will be issued to: <b>{fullName}</b>
      </p>
    </>
  );
}
```

ì—¬ê¸° í¼ì€ ì„¸ê°€ì§€ì˜ ìƒíƒœ ë³€ìˆ˜(`firstName`, `lastName`, `fullName`)ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ `fullName`ì€ ì¤‘ë³µì…ë‹ˆë‹¤. `firstName`ê³¼ `lastName`ìœ¼ë¡œ ë¶€í„° `fullName`ì„ í•­ìƒ ë Œë”ë§ ë™ì•ˆ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‹ˆ ìƒíƒœì—ì„œ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
  const [firstName, setFirstName] = useState('');
  const [lastName, setLastName] = useState('');
  - const [fullName, setFullName] = useState('');
  
  const fullName = firstName + ' ' + lastName;

  function handleFirstNameChange(e) {
    setFirstName(e.target.value);
    - setFullName(e.target.value + ' ' + lastName);
  }

  function handleLastNameChange(e) {
    setLastName(e.target.value);
    - setFullName(firstName + ' ' + e.target.value);
  }
```

ì—¬ê¸°, `fullName` ì€ ìƒíƒœ ë³€ìˆ˜ê°€ ì•„ë‹™ë‹ˆë‹¤. ëŒ€ì‹  ë Œë”ë§ë™ì•ˆì— ê³„ì‚°ë©ë‹ˆë‹¤.

```tsx
const fullName = firstName + ' ' + lastName;
```

ê²°ê³¼ì ìœ¼ë¡œ change handlersëŠ” ë” ì´ìƒ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ íŠ¹ë³„í•œ ë™ì‘ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. `setFirstName` ë˜ëŠ” `setLastName`ì„ í˜¸ì¶œí•  ë•Œ, ë¦¬ë Œë”ë§ì´ íŠ¸ë¦¬ê±°ë˜ê³  ë‹¤ìŒ `fullName`ì´ ìƒˆ ë°ì´í„°ë¡œ ê³„ì‚°ë  ê²ƒ ì…ë‹ˆë‹¤.

### Deep Dive: **Donâ€™t mirror props in state**

ë‹¤ìŒ ì½”ë“œëŠ” ë¶ˆí•„ìš”í•œ stateì˜ ì¼ë°˜ì ì¸ ì˜ˆì…ë‹ˆë‹¤.

```tsx
function Message({ messageColor }) {
	const [color, setColor] = useState(messageColor);
}
```

`color` ìƒíƒœ ë³€ìˆ˜ëŠ” `messageColor` propsë¥¼ í†µí•´ì„œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ë¬¸ì œëŠ” ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë‚˜ì¤‘ì— `messageColor`ì˜ ê°’ì„ ë‹¤ë¥´ê²Œ ì „ë‹¬í•´ì¤€ë‹¤ë©´(ex, â€˜redâ€™ ëŒ€ì‹  â€˜blueâ€™ì™€ ê°™ì´), `color` ìƒíƒœ ë³€ìˆ˜ëŠ” ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šì„ ê²ƒ ì…ë‹ˆë‹¤. ìƒíƒœëŠ” ì˜¤ì§ ì²«ë²ˆì§¸ ë Œë”ë§ ë™ì•ˆì—ë§Œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.

ê·¸ ë•Œë¬¸ì— ìƒíƒœ ë³€ìˆ˜ì˜ ì¼ë¶€ propsë¥¼ â€œë¯¸ëŸ¬ë§â€í•˜ë©´ í˜¼ë€ì„ ì¼ìœ¼í‚¤ëŠ” ì´ìœ ì…ë‹ˆë‹¤. ëŒ€ì‹ , `messageColor` propsë¥¼ ì½”ë“œì— ì§ì ‘ ì‚¬ìš©í•˜ì„¸ìš”. ë§Œì•½ ë” ì§§ì€ ì´ë¦„ì„ ì£¼ê¸¸ ì›í•œë‹¤ë©´ constantë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤

```tsx
function Message({ messageColor }) {
	const color = messageColor;
}
```

ì´ëŸ¬í•œ ë°©ë²•ì€ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ë¡œë¶€í„° ì „ë‹¬ëœ propsì™€ ë™ê¸°í™”ë¥¼ ìƒì§€ ì•ŠìŠµë‹ˆë‹¤.

propsë¥¼ ìƒíƒœë¡œ â€œë¯¸ëŸ¬ë§â€í•˜ëŠ” ê²ƒì€ íŠ¹ì • propsì— ëŒ€í•œ ëª¨ë“  ì—…ë°ì´íŠ¸ë¥¼ ë¬´ì‹œí•˜ê¸°ë¥¼ ì›í•  ë•Œì—ë§Œ ì˜ë¯¸ê°€ ìˆìŠµë‹ˆë‹¤. ì»¨ë²¤ì…˜ì— ë”°ë¥´ë©´, props ì´ë¦„ì˜ ì‹œì‘ì— `initial` ë˜ëŠ” `default` ë¥¼ ì¶”ê°€í•˜ì—¬ ìƒˆë¡œìš´ ê°’ì´ ë¬´ì‹œë¨ì„ ëª…í™•í•˜ê²Œ í•˜ì„¸ìš”.

```tsx
function Message({ initialColor }) {
	const [color, setColor] = useState(initialColor);
}
```

## **Avoid duplication in state**

ë‹¹ì‹ ì´ ê°„ì‹ì„ ì„ íƒí•  ìˆ˜ ìˆëŠ” ë©”ë‰´ ëª©ë¡ ì»´í¬ë„ŒíŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.

```tsx
import { useState } from 'react';

const initialItems = [
  { title: 'pretzels', id: 0 },
  { title: 'crispy seaweed', id: 1 },
  { title: 'granola bar', id: 2 },
];

export default function Menu() {
  const [items, setItems] = useState(initialItems);
  const [selectedItem, setSelectedItem] = useState(
    items[0]
  );

  return (
    <>
      <h2>What's your travel snack?</h2>
      <ul>
        {items.map(item => (
          <li key={item.id}>
            {item.title}
            {' '}
            <button onClick={() => {
              setSelectedItem(item);
            }}>Choose</button>
          </li>
        ))}
      </ul>
      <p>You picked {selectedItem.title}.</p>
    </>
  );
}
```

í˜„ì¬ `selectedItem` ìƒíƒœ ë³€ìˆ˜ì— ê°ì²´ë¡œì„œ ì„ íƒëœ ì•„ì´í…œì„ ì €ì¥í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í›Œë¥­í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. `selectedItem` ì˜ ì»¨í…ì¸ ëŠ” `item` ëª©ë¡ ë‚´ë¶€ì˜ ì•„ì´í…œ ì¤‘ í•˜ë‚˜ì™€ ê°™ì€ ê°ì²´ì…ë‹ˆë‹¤. ì´ëŠ” ë‘ê°€ì§€ ìœ„ì¹˜ì— ì¤‘ë³µìœ¼ë¡œ ì•„ì´í…œì— ëŒ€í•œ ì •ë³´ê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ê²ƒì´ ì™œ ë¬¸ì œì¼ê¹Œìš”? ê°ê°ì˜ ì•„ì´í…œì´ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•´ë´…ì‹œë‹¤

```tsx
import { useState } from 'react';

const initialItems = [
  { title: 'pretzels', id: 0 },
  { title: 'crispy seaweed', id: 1 },
  { title: 'granola bar', id: 2 },
];

export default function Menu() {
  const [items, setItems] = useState(initialItems);
  const [selectedItem, setSelectedItem] = useState(
    items[0]
 

  function handleItemChange(id, e) {
    setItems(items.map(item => {
      if (item.id === id) {
        return {
          ...item,
          title: e.target.value,
        };
      } else {
        return item;
      }
    }));
  }

  return (
    <>
      <h2>What's your travel snack?</h2> 
      <ul>
        {items.map((item, index) => (
          <li key={item.id}>
            <input
              value={item.title}
              onChange={e => {
                handleItemChange(item.id, e)
              }}
            />
            {' '}
            <button onClick={() => {
              setSelectedItem(item);
            }}>Choose</button>
          </li>
        ))}
      </ul>
      <p>You picked {selectedItem.title}.</p>
    </>
  );
}
```

ë‹¹ì‹ ì´ ì•„ì´í…œì˜ â€œChooseâ€ë¥¼ ì²«ë²ˆì§¸ë¡œ í´ë¦­í•˜ê³  ìˆ˜ì •í•œë‹¤ë©´ inputì€ ì—…ë°ì´íŠ¸ ë˜ì—ˆì§€ë§Œ ì•„ë˜ìª½ì˜ ë¼ë²¨ì—ëŠ” ìˆ˜ì •í•œ ë‚´ìš©ì´ ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” ë‹¹ì‹ ì´ ì¤‘ë³µëœ ìƒíƒœë¥¼ ê°€ì§€ê³  ìˆê³  `selectedItem` ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì„ ìŠì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

`selectedItem` ì—­ì‹œ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆì§€ë§Œ, ì‰¬ìš´ ìˆ˜ì •ì€ ì¤‘ë³µì„ ì œê±°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” `selectedItem` ê°ì²´(item ë‚´ë¶€ì— ê°ì²´ì™€ ì¤‘ë³µì„ ìƒì„±í•˜ëŠ”) ëŒ€ì‹ ì—, `selectedId`ë¥¼ ìƒíƒœë¡œ ìœ ì§€í•˜ê³  ê·¸ ì•„ì´ë””ë¥¼ ê°€ì§€ê³  `items` ë°°ì—´ì—ì„œ `selectedItem` ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
export default function Menu() {
  const [items, setItems] = useState(initialItems);
  const [selectedId, setSelectedId] = useState(0);

  const selectedItem = items.find(item =>
    item.id === selectedId
  );
  
  ...
  
              <button onClick={() => {
              setSelectedId(item.id);
            }}>Choose</button>
}

```

ìƒíƒœëŠ” ì•„ë˜ì™€ ê°™ì´ ì¤‘ë³µìœ¼ë¡œ ì‚¬ìš©ë˜ì—ˆì—ˆìŠµë‹ˆë‹¤.

`items = [{ id: 0, title: 'pretzels'}, ...]`

`selectedItem = {id: 0, title: 'pretzels'}`

ë³€ê²½ ì´í›„ëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

`items = [{ id: 0, title: 'pretzels'}, ...]`

`selectedId = 0` 

ì¤‘ë³µì€ ì‚¬ë¼ì§€ê³  í•„ìˆ˜ì ì¸ ìƒíƒœë§Œ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤!

ì´ì œ ì„ íƒëœ ì•„ì´í…œì„ ìˆ˜ì •í•œë‹¤ë©´ ë©”ì„¸ì§€ëŠ” ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë˜ì–´ ë³´ì¼ ê²ƒ ì…ë‹ˆë‹¤. ì´ëŠ” `setItems` ê°€ ë¦¬ë Œë”ë§ì„ íŠ¸ë¦¬ê±°í•˜ê³  `items.find()` ëŠ” ì—…ë°ì´íŠ¸ëœ íƒ€ì´í‹€ì„ ê°€ì§€ê³ ìˆëŠ” ì•„ì´í…œì„ ì°¾ì„ ê²ƒ ì…ë‹ˆë‹¤. ì„ íƒí•œ IDë§Œ í•„ìˆ˜ì´ë¯€ë¡œ ì„ íƒí•œ í•­ëª©ì„ stateë¡œ ìœ ì§€í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ë‚˜ë¨¸ì§€ëŠ” ë Œë”ë§ ë™ì•ˆì— ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## **Avoid deeply nested state**

í–‰ì„±, ëŒ€ë¥™, êµ­ê°€ë¡œ êµ¬ì„±ëœ ì—¬í–‰ ê³„íšì„ ìƒìƒí•´ë³´ì„¸ìš”. ì•„ë˜ ì˜ˆì œì²˜ëŸ¼ ì¤‘ì²©ëœ ê°ì²´ë‚˜ ë°°ì—´ì„ ì‚¬ìš©í•˜ì—¬ ìƒíƒœì˜ êµ¬ì¡°ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

https://ko.react.dev/learn/choosing-the-state-structure#avoid-deeply-nested-state

```tsx
import { useState } from 'react';
import { initialTravelPlan } from './places.js';

function PlaceTree({ place }) {
  const childPlaces = place.childPlaces;
  return (
    <li>
      {place.title}
      {childPlaces.length > 0 && (
        <ol>
          {childPlaces.map(place => (
            <PlaceTree key={place.id} place={place} />
          ))}
        </ol>
      )}
    </li>
  );
}

export default function TravelPlan() {
  const [plan, setPlan] = useState(initialTravelPlan);
  const planets = plan.childPlaces;
  return (
    <>
      <h2>Places to visit</h2>
      <ol>
        {planets.map(place => (
          <PlaceTree key={place.id} place={place} />
        ))}
      </ol>
    </>
  );
}

```

ì—¬ê¸°ì— ë²„íŠ¼ì„ ì¶”ê°€í•´ì„œ ì´ë¯¸ ë°©ë¬¸í•œ ì¥ì†Œë¥¼ ì‚­ì œí•˜ê¸¸ ì›í•œë‹¤ê³  í•´ë´…ì‹œë‹¤. ì–´ë–»ê²Œ í•˜ë©´ ì¢‹ì„ê¹Œìš”? ì¤‘ì²©ëœ ê°ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” ë³€ê²½ë˜ëŠ” ë¶€ë¶„ë¶€í„° ë³µì‚¬ë³¸ì„ ëª¨ë‘ ë§Œë“¤ì–´ì•¼í•©ë‹ˆë‹¤. ê¹Šê²Œ ì¤‘ì²©ë˜ì–´ìˆëŠ” ì¥ì†Œë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•´ì„œëŠ” ìƒìœ„ ì²´ì¸ì„ ëª¨ë‘ ë³µì‚¬í•´ì•¼í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì½”ë“œëŠ” ë§¤ìš° ì¥í™©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìƒíƒœê°€ ì—…ë°ì´íŠ¸í•˜ê¸° ì‰½ì§€ ì•Šê²Œ ì—„ì²­ ì¤‘ì²©ë˜ì–´ìˆë‹¤ë©´, í‰íƒ„í™”í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”. ë°ì´í„°ë¥¼ ì¬êµ¬ì¡°í™”í•˜ëŠ” í•œê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ê° `place`ê°€ *ìì‹ ì¥ì†Œ*ì˜ ë°°ì—´ì„ ê°€ì§€ëŠ” íŠ¸ë¦¬ êµ¬ì¡° ëŒ€ì‹ , ê° ì¥ì†Œê°€ *ìì‹ ì¥ì†Œ ID*ì˜ ë°°ì—´ì„ ê°€ì§€ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë‹¤ìŒ ê° ì¥ì†Œ IDì—ì„œ í•´ë‹¹ ì¥ì†Œë¡œ ë§¤í•‘ì„ ì €ì¥í•©ë‹ˆë‹¤

as-is

```tsx
export const initialTravelPlan = {
  id: 0,
  title: '(Root)',
  childPlaces: [{
    id: 1,
    title: 'Earth',
    childPlaces: [{
      id: 2,
      title: 'Africa',
      childPlaces: [{
        id: 3,
...
```

to-be

```tsx
export const initialTravelPlan = {
  0: {
    id: 0,
    title: '(Root)',
    childIds: [1, 42, 46],
  },
  1: {
    id: 1,
    title: 'Earth',
    childIds: [2, 10, 19, 26, 34]
  },
  2: {
    id: 2,
    title: 'Africa',
    childIds: [3, 4, 5, 6 , 7, 8, 9]
  }, 
```

í˜„ì¬ ìƒíƒœê°€ í‰íƒ„í™”(ë˜ëŠ” ì •ê·œí™”)ë˜ì—ˆê³ , ì¤‘ì²©ëœ ì•„ì´í…œì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì´ ì‰¬ì›Œì¡ŒìŠµë‹ˆë‹¤.

ì¥ì†Œë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒ ë‘ ë‹¨ê³„ì˜ ìƒíƒœë§Œ ì—…ë°ì´íŠ¸í•˜ë©´ ë©ë‹ˆë‹¤.

- ë¶€ëª¨ ì¥ì†Œì˜ ì—…ë°ì´íŠ¸ëœ ë²„ì „ì€ ì œê±°ëœ IDë¥¼ `childIds` ë°°ì—´ì—ì„œ ì œì™¸í•´ì•¼ í•©ë‹ˆë‹¤.
- ë£¨íŠ¸ í…Œì´ë¸” ê°ì²´ì˜ ì—…ë°ì´íŠ¸ëœ ë²„ì „ì—ëŠ” ìƒìœ„ ìœ„ì¹˜ì˜ ì—…ë°ì´íŠ¸ëœ ë²„ì „ì´ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

```tsx
import { useState } from 'react';
import { initialTravelPlan } from './places.js';

export default function TravelPlan() {
  const [plan, setPlan] = useState(initialTravelPlan);

  function handleComplete(parentId, childId) {
    const parent = plan[parentId];
    // Create a new version of the parent place
    // that doesn't include this child ID.
    const nextParent = {
      ...parent,
      childIds: parent.childIds
        .filter(id => id !== childId)
    };
    // Update the root state object...
    setPlan({
      ...plan,
      // ...so that it has the updated parent.
      [parentId]: nextParent
    });
  }

  const root = plan[0];
  const planetIds = root.childIds;
  return (
    <>
      <h2>Places to visit</h2>
      <ol>
        {planetIds.map(id => (
          <PlaceTree
            key={id}
            id={id}
            parentId={0}
            placesById={plan}
            onComplete={handleComplete}
          />
        ))}
      </ol>
    </>
  );
}

function PlaceTree({ id, parentId, placesById, onComplete }) {
  const place = placesById[id];
  const childIds = place.childIds;
  return (
    <li>
      {place.title}
      <button onClick={() => {
        onComplete(parentId, id);
      }}>
        Complete
      </button>
      {childIds.length > 0 &&
        <ol>
          {childIds.map(childId => (
            <PlaceTree
              key={childId}
              id={childId}
              parentId={id}
              placesById={placesById}
              onComplete={onComplete}
            />
          ))}
        </ol>
      }
    </li>
  );
}
```

ì´ì™€ ê°™ì´ ìƒíƒœë¥¼ ì›í•˜ëŠ” ë§Œí¼ ì¤‘ì²©í•  ìˆ˜ ìˆì§€ë§Œ, í‰íƒ„í™”í•˜ë©´ ë§ì€ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œí•˜ë©´ ìƒíƒœë¥¼ ë” ì‰½ê²Œ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆê³  ì¤‘ì²©ëœ ê°ì²´ì˜ ë‹¤ë¥¸ ë¶€ë¶„ì— ì¤‘ë³µì´ ìƒê¸°ì§€ ì•Šë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Deep Dive: **Improving memory usage**

ì´ìƒì ìœ¼ë¡œëŠ” â€œí…Œì´ë¸”â€ê°ì²´ì—ì„œ ì‚­ì œëœ í•­ëª©(ë° ê·¸ í•˜ìœ„ í•­ëª©)ë„ ì œê±°í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ê°œì„ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì´ ë²„ì „ì€ ê·¸ë ‡ê²Œí•˜ê³ , immerë¥¼ ì‚¬ìš©í•˜ì—¬ ì—…ë°ì´íŠ¸ ë¡œì§ì„ ë”ìš± ê°„ê²°í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

```tsx
import { useImmer } from 'use-immer';
import { initialTravelPlan } from './places.js';

export default function TravelPlan() {
  const [plan, updatePlan] = useImmer(initialTravelPlan);

  function handleComplete(parentId, childId) {
    updatePlan(draft => {
      // Remove from the parent place's child IDs.
      const parent = draft[parentId];
      parent.childIds = parent.childIds
        .filter(id => id !== childId);

      // Forget this place and all its subtree.
      deleteAllChildren(childId);
      function deleteAllChildren(id) {
        const place = draft[id];
        place.childIds.forEach(deleteAllChildren);
        delete draft[id];
      }
    });
  }

  const root = plan[0];
  const planetIds = root.childIds;
  return (
    <>
      <h2>Places to visit</h2>
      <ol>
        {planetIds.map(id => (
          <PlaceTree
            key={id}
            id={id}
            parentId={0}
            placesById={plan}
            onComplete={handleComplete}
          />
        ))}
      </ol>
    </>
  );
}

function PlaceTree({ id, parentId, placesById, onComplete }) {
  const place = placesById[id];
  const childIds = place.childIds;
  return (
    <li>
      {place.title}
      <button onClick={() => {
        onComplete(parentId, id);
      }}>
        Complete
      </button>
      {childIds.length > 0 &&
        <ol>
          {childIds.map(childId => (
            <PlaceTree
              key={childId}
              id={childId}
              parentId={id}
              placesById={placesById}
              onComplete={onComplete}
            />
          ))}
        </ol>
      }
    </li>
  );
}
```

ë•Œë¡œëŠ” ì¤‘ì²©ëœ ìƒíƒœì˜ ì¼ë¶€ë¥¼ í•˜ìœ„ì»´í¬ë„ŒíŠ¸ë¡œ ì´ë™í•˜ì—¬ ìƒíƒœì˜ ì¤‘ì²©ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” í•­ëª©ì˜ ë§ˆìš°ìŠ¤ì˜¤ë²„ ë“±ê³¼ ê°™ì€ ì €ì¥í•  í•„ìš”ê°€ ì—†ëŠ” ì¼ì‹œì ì¸ UI ìƒíƒœì— íš¨ê³¼ì ì…ë‹ˆë‹¤.

## ì •ë¦¬

- ë‘ê°€ì§€ ìƒíƒœê°€ ê°™ì´ ì—…ë°ì´íŠ¸ ëœë‹¤ë©´ í•˜ë‚˜ë¡œ í•©ì¹˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì„¸ìš”
- â€œë¶ˆê°€ëŠ¥í•œâ€ ìƒíƒœë¥¼ ë§Œë“œëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´ ìƒíƒœ ë³€ìˆ˜ë¥¼ ì‹ ì¤‘í•˜ê²Œ ì„ íƒí•˜ì„¸ìš”
- ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ì‹¤ìˆ˜í•  ê°€ëŠ¥ì„±ì„ ì¤„ì´ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ì„¸ìš”
- ë™ê¸°í™” ìƒíƒœë¥¼ ìœ ì§€í•  í•„ìš”ê°€ ì—†ë„ë¡ ì¤‘ë³µ ë° ì¤‘ë³µ ìƒíƒœë¥¼ í”¼í•˜ì„¸ìš”
- íŠ¹ë³„íˆ ì—…ë°ì´íŠ¸ë¥¼ ë§‰ì•„ì•¼í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ propsë¥¼ stateì— ë„£ì§€ ë§ˆì„¸ìš”
- ì„ íƒê³¼ ê°™ì€ UI íŒ¨í„´ì—ì„œëŠ” ê°ì²´ ëŒ€ì‹  ID ë˜ëŠ” ì¸ë±ìŠ¤ë¥¼ ìƒíƒœë¡œ ìœ ì§€í•˜ì„¸ìš”.
- ê¹Šì´ ì¤‘ì²©ëœ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒì´ ë³µì¡í•˜ë‹¤ë©´, í‰íƒ„í™”í•˜ì„¸ìš”.
